<ion-view title="Montage" cache-view="false" hide-nav-bar="{{minimal}}">
    <ion-nav-buttons side="left">
        <button class="button button-icon button-clear ion-navicon" ng-click="openMenu()"></button>
         <button class="button button-icon button-clear ion-eye" ng-click="hideUnhide();">&nbsp;
        </button>
        <button data-badge="{{$root.alarmCount}}" class="animated infinite tada button button-icon button-clear ion-ios-bell notification-badge" ng-click="handleAlarms();" ng-if="$root.isAlarm"></button>
        
    </ion-nav-buttons>



    <ion-nav-buttons side="right">

        <button class="button button-icon button-clear ion-arrow-move" ng-click="dragToggle();">&nbsp;
        </button>
        
        <button class="button button-icon button-clear ion-loop" ng-click="resetSizes();">&nbsp;
        </button>
        
       
        
        
      
        <button class="button button-icon button-clear ion-android-contract" ng-click="switchMinimal()">
        </button>

    </ion-nav-buttons>

    <ion-content ng-cloak has-bouncing="false" style="background-color:#444444" delegate-handle="montage-delegate" >

        <!--<ion-refresher pulling-text="Pull to reload Monitors..." spinner="bubbles" on-refresh="doRefresh()">
        </ion-refresher>-->

        <span ng-show="!minimal">
            
            <span ng-click="sliderChanged(1)" style="float:right;margin-top:0px;padding-top:8px;background-color:#6d0909;color:#fff;font-size:25px;opacity:1;width:40px;height:36px;border-radius: 0px 0px 0px 5px;">&nbsp;<i class="ion-plus-circled">&nbsp;</i></span>
            
            <span ng-click="sliderChanged(-1)" style="float:left;margin-top:0px;padding-top:8px;background-color:#6d0909;color:#fff;font-size:22px;opacity:1;width:40px;height:36px;border-radius: 0px 0px 5px 0px;">&nbsp;<i class="ion-minus-circled">&nbsp;</i></span>
            <br/><br/>
                
                
        </span>
        

        <div class="grid" id="mygrid">
            <div class="grid-sizer grid-item-10"></div>
            <span ng-repeat="monitor in MontageMonitors|limitTo: monLimit" 
                  ng-if="monitor.Monitor.Function!='None' &&  monitor.Monitor.Enabled !='0' ">
            <div class="grid-item grid-item-{{monitor.Monitor.gridScale}} " data-item-id="{{monitor.Monitor.Id}}" data-item-size="{{monitor.Monitor.gridScale}}" data-item-listdisplay="{{monitor.Monitor.listDisplay}}" >
                <figure class="{{dragBorder}}" ng-show=" monitor.Monitor.listDisplay!='noshow'">
                    <div ng-if="!isModalActive" >
                        <div ng-if="$root.authSession!='undefined' && !isBackground() && !areImagesLoading">
                            <div ng-if = "!minimal">
                                <div>
                                <img   class="{{monitor.Monitor.selectStyle}}" id="img-{{$index}}" image-spinner-src="{{LoginData.streamingurl}}/nph-zms?mode=single&monitor={{monitor.Monitor.Id}}&scale={{LoginData.montageQuality}}{{$root.authSession}}&rand={{$root.rand}}" ng-click="!isDragabillyOn?openModal(monitor.Monitor.Id, monitor.Monitor.Controllable, monitor.Monitor.ControlId, monitor.Monitor.connKey):toggleSelectItem($index);" image-spinner-loader="lines" on-swipe-up="swipeUp()" on-swipe-down="swipeDown()"  />
                                
                                <!--<div style="position:absolute;top:40%; left:50%;opacity:0.5;"><button  ng-class="monitor.Monitor.listDisplay=='show'?'button button-positive button-small icon  ion-ios-eye':'button button-assertive button-small icon  ion-eye-disabled'" ng-click="toggleHide(monitor)" ng-if="isDragabillyOn"></button></div>
                                </div>-->
                                
                                
                            </div> 

                            <div ng-if = "minimal">
                                <img id="{{img-$index}}" image-spinner-src="{{LoginData.streamingurl}}/nph-zms?mode=single&monitor={{monitor.Monitor.Id}}&scale={{LoginData.montageQuality}}{{$root.authSession}}&rand={{$root.rand}}"  ng-click="!isDragabillyOn?openModal(monitor.Monitor.Id, monitor.Monitor.Controllable, monitor.Monitor.ControlId, monitor.Monitor.connKey):toggleSelectItem($index);" image-spinner-loader="lines" swipe-up="swipeUp()" on-swipe-down="swipeDown()"   />
                            </div>
                        </div>

                        <div ng-if="!$root.authSession=='undefined' || isBackground() || areImagesLoading">
                            <img image-spinner-src="img/pausevideo.png" />
                        </div>

                        
                     

                        <figcaption id="slowpulse" ng-class="monitor.Monitor.isAlarmed=='true'?'alarmed-figcaption animated infinite flash':'normal-figcaption'" >

                                &nbsp;<i class="ion-monitor"></i>
                               {{monitor.Monitor.Name}}&nbsp;

                        </figcaption>


                        
                    </div> <!-- modal not active-->
                    <div ng-if="isModalActive">
                        <img image-spinner-src="img/pausevideo.png" />
                    </div>
                </figure>
            </div>
            </span>       <!-- ngrepeat -->
        </div>

 




        <ion-item ng-show="!MontageMonitors.length">
            No monitors to display.
        </ion-item>



    </ion-content>

    <div ng-show="minimal">
        <nav mfb-menu position="br" effect="zoomin" label="collapse" active-icon="ion-chevron-down" resting-icon="ion-chevron-up" toggling-method="click">

            <button mfb-button icon="ion-arrow-expand" label="increase size" ng-click="changeSize(1)">
            </button>
            <button mfb-button icon="ion-arrow-shrink" label="decrease size" ng-click="changeSize(-1)">
            </button>
            <button mfb-button icon="ion-refresh" label="refresh" ng-click="reloadView();">
            </button>
            <button mfb-button icon="ion-close" label="exit full screen" ng-click="switchMinimal()">
            </button>
        </nav>
        
        
        <span class="modal-alarm-badge">
            <a data-badge="{{$root.alarmCount}}" class="animated infinite tada button icon  ion-ios-bell notification-badge button-assertive" 
                    ng-click="handleAlarmsWhileMinimized();" ng-if="$root.isAlarm"></a>
        </span>

    </div>
    <br/>

</ion-view>